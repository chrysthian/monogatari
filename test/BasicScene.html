
<!DOCTYPE html>
<html>
    <head>
        <title>First Three/Monogatari Scene</title>
        <script type="text/javascript" src="../lib/ScriptLoader.js"></script>
        <script>
        scriptLoader.load( [ 'engine/GameManager.js', 'engine/entity/component/Sprite.js', 'core/io/Keyboard.js' ], '../',
          function() {
            Monogatari.GameManager.init();
            Monogatari.SceneManager.createScene( 'mainScene' );
            Monogatari.SceneManager.createCamera( 'mainCamera', 'mainScene' );

            var go = Monogatari.ObjectManager.create( 'knight' );

            go.addComponent( 'node', new Monogatari.Node( new THREE.Vector3( 300, 300, 0 ) ) );

            var sprite = new Monogatari.Sprite(  'mainScene', 'assets/sprite-knight.png', 32, 32, 4, 3);
            sprite.getMaterial().transparent = true;

            go.addComponent( 'sprite-knight',  sprite);

            go.update = function(){
                var node = this.findComponent( 'node' );
                var sprite = this.findComponent( 'sprite-knight' );
                var animationSpeed = 200;

                if ( Monogatari.Time.compare( sprite.lastUpdate ) > animationSpeed ) {
                  sprite.nextFrame();
                  sprite.lastUpdate = Monogatari.Time.getTime();
                }
            }

            Monogatari.ObjectManager.connect( 'world', 'knight' );

            Monogatari.GameManager.run();
          });
        </script>
    </head>
    <body>

    </body>
</html>